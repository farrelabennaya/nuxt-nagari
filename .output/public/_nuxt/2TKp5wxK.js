import{z as n,T as a}from"./ymCw7azN.js";const r=n("token",{state:()=>({token:null,loggedIn:!1}),persist:!0,getters:{getToken:t=>t.token,getStatus:t=>t.loggedIn},actions:{setToken(t){this.token=t,this.loggedIn=!0},removeToken(){return i().$reset(),this.$reset(),a("/auth/login")}}}),i=n("auth",{state:()=>({user:{}}),persist:{paths:["user"]},getters:{getUser:t=>t.user},actions:{async login(t){try{const{data:e}=await $fetch("http://laravel-api.test/api/login",{method:"POST",body:{...t}});this.commonSetter(e)}catch(e){throw e}},async register(t){try{const{data:e}=await $fetch("http://laravel-api.test/api/register",{method:"POST",body:{...t}});this.commonSetter(e)}catch(e){throw e}},async createuser(t){const e=r();try{const{data:o}=await $fetch("http://laravel-api.test/api/users",{method:"POST",body:{...t},headers:{Accept:"application/json",Authorization:`Bearer ${e.getToken}`}});return o}catch(o){throw o}},async createPetugas(t){const e=r();try{const{data:o}=await $fetch("http://laravel-api.test/api/users/petugas",{method:"POST",body:{...t},headers:{Accept:"application/json",Authorization:`Bearer ${e.getToken}`}});return o}catch(o){throw o}},async logout(){const t=r();try{const e=await $fetch("http://laravel-api.test/api/logout",{method:"POST",headers:{Accept:"application/json",Authorization:`Bearer ${t.getToken}`}});return t.removeToken(),this.user={},console.log(e),a("/auth/login")}catch(e){throw e}},commonSetter(t){r().setToken(t.token),this.user={...t.user,role_id:t.user.role.id};const s={1:"/admin",2:"/petugas",3:"/warga"}[this.user.role_id]||"/";console.log("Redirecting to:",s),a(s)}}});export{r as a,i as u};
