import{A as W}from"./Dl1Rth-w.js";import{_ as Y}from"./CrH4gh9h.js";import{z as Q,j as X,k as ee,l as M,m as h,f as ae,c as n,b as O,a as e,t as u,n as te,q as p,y as w,x as g,v as y,F as k,s as f,h as I,o as r,A as se,p as oe,e as ne}from"./ymCw7azN.js";import{u as re}from"./2TKp5wxK.js";import{_ as le}from"./DlAUqK2U.js";import"./CPXeGkS5.js";const ie=Q("formStore",{state:()=>({anggotaKeluargaForms:[]}),actions:{addAnggota(_){this.anggotaKeluargaForms.push(_)},updateAnggota(_,A){this.anggotaKeluargaForms[_]=A},clearForms(){this.anggotaKeluargaForms=[]},resetForms(){this.anggotaKeluargaForms=[]}}}),l=_=>(oe("data-v-27e5a71c"),_=_(),ne(),_),ue={class:"flex overflow-hidden bg-white pt-16"},de={id:"main-content",class:"h-full w-full bg-gray-50 relative overflow-y-auto sm:ml-64"},ge={class:"pt-6 px-4 ml-5 mr-5"},ce={class:"text-lg font-bold mb-4"},me={class:"min-h-screen flex"},pe={class:"w-full"},be={class:"card bg-white p-10 rounded-lg shadow-md md:w-3/5 mx-auto lg:w-1/3"},_e=l(()=>e("h3",{class:"text-center text-2xl font-semibold"}," Form Data Anggota Keluarga ",-1)),he={class:"mb-5"},ke=l(()=>e("label",{for:"keluarga_id",class:"block text-sm font-medium text-gray-700"},"Keluarga ID",-1)),fe={key:0,class:"text-red-500"},ve={class:"mb-5"},ye=l(()=>e("label",{for:"nama",class:"block text-sm font-medium text-gray-700"},"Nama",-1)),xe={key:0,class:"text-red-500"},we={class:"mb-5"},Ae=l(()=>e("label",{for:"nik",class:"block text-sm font-medium text-gray-700"},"NIK",-1)),Ke={key:0,class:"text-red-500"},Te={class:"mb-5"},Pe=l(()=>e("label",{for:"tempat_lahir",class:"block text-sm font-medium text-gray-700"},"Tempat Lahir",-1)),Se={key:0,class:"text-red-500"},je={class:"mb-5"},Ie=l(()=>e("label",{for:"tanggal_lahir",class:"block text-sm font-medium text-gray-700"},"Tanggal Lahir",-1)),Be={key:0,class:"text-red-500"},Fe={class:"mb-5"},Me=l(()=>e("label",{for:"agama",class:"block text-sm font-medium text-gray-700"},"Agama",-1)),Oe=l(()=>e("option",{disabled:"",value:""},"Pilih Agama",-1)),Ce=["value"],De={key:0,class:"text-red-500"},Ne={class:"mb-5"},Ee=l(()=>e("label",{for:"jenis_kelamin",class:"block text-sm font-medium text-gray-700"},"Jenis Kelamin",-1)),Le=l(()=>e("option",{disabled:"",value:""},"Pilih Jenis Kelamin",-1)),Ue=["value"],Ve={key:0,class:"text-red-500"},Re={class:"mb-5"},He=l(()=>e("label",{for:"pendidikan",class:"block text-sm font-medium text-gray-700"},"Pendidikan",-1)),Je=l(()=>e("option",{disabled:"",value:""},"Pilih Pendidikan",-1)),$e=["value"],qe={key:0,class:"text-red-500"},ze={class:"mb-5"},Ge=l(()=>e("label",{for:"pekerjaan",class:"block text-sm font-medium text-gray-700"},"Pekerjaan",-1)),Ze=l(()=>e("option",{disabled:"",value:""},"Pilih Pekerjaan",-1)),We=["value"],Ye={key:0,class:"text-red-500"},Qe={class:"mb-5"},Xe=l(()=>e("label",{for:"status_perkawinan",class:"block text-sm font-medium text-gray-700"},"Status Perkawinan",-1)),ea=l(()=>e("option",{disabled:"",value:""},"Pilih Status Perkawinan",-1)),aa=["value"],ta={key:0,class:"text-red-500"},sa={class:"mb-5"},oa=l(()=>e("label",{for:"hubungan_keluarga",class:"block text-sm font-medium text-gray-700"},"Hubungan Keluarga",-1)),na=l(()=>e("option",{disabled:"",value:""},"Pilih Hubungan Keluarga",-1)),ra=["value"],la={key:0,class:"text-red-500"},ia={class:"flex justify-between"},ua={key:1,type:"submit",class:"text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 mb-2"},da={class:"flex justify-center mt-4"},ga=["onClick"],ca={key:0,id:"toast-success",class:"fixed bottom-4 right-4 flex items-center w-full max-w-xs p-4 mb-4 text-gray-500 bg-white rounded-lg shadow",role:"alert"},ma=l(()=>e("div",{class:"inline-flex items-center justify-center flex-shrink-0 w-8 h-8 text-green-500 bg-green-100 rounded-lg"},[e("svg",{class:"w-5 h-5","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:"M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5Zm3.707 8.207-4 4a1 1 0 0 1-1.414 0l-2-2a1 1 0 1 1 1.414-1.414L9 10.586l3.293-3.293a1 1 0 1 1 1.414 1.414Z"})]),e("span",{class:"sr-only"},"Check icon")],-1)),pa={class:"ml-3 text-sm font-normal"},ba=l(()=>e("span",{class:"sr-only"},"Close",-1)),_a=l(()=>e("svg",{class:"w-3 h-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 14 14"},[e("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"})],-1)),ha=[ba,_a],ka={key:1,class:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50"},fa={class:"bg-white p-6 rounded-lg shadow-lg"},va=l(()=>e("h2",{class:"text-xl font-semibold mb-4"}," Apakah Anda Yakin Untuk Melakukan Konfirmasi? ",-1)),ya=l(()=>e("p",{class:"mb-4"},"Pastikan Semua Data Benar",-1)),xa={class:"flex justify-end"},wa={__name:"createAnggota",setup(_){const A=re(),m=ie(),C=X(),B=ee(),s=M({keluarga_id:B.query.keluarga_id||"",nama:"",nik:"",tempat_lahir:"",tanggal_lahir:"",agama:"",jenis_kelamin:"",pendidikan:"",pekerjaan:"",status_perkawinan:"",hubungan_keluarga:""}),o=h([]);h(!1);const v=M({message:"",show:!1}),K=h(!1),T=parseInt(B.query.jumlah_anggota,10)||1,d=h(1),D=h(!1),N=h(!0),E=["Islam","Kristen","Katolik","Hindu","Buddha","Khonghucu"],L=["Laki-laki","Perempuan"],U=["TIDAK / BELUM SEKOLAH","TAMAT SD / SEDERAJAT","SLTA / SEDERAJAT","SLTP/SEDERAJAT","BELUM TAMAT SD/SEDERAJAT","DIPLOMA IV/ STRATA I","DIPLOMA I / II","AKADEMI/ DIPLOMA III/S. MUDA","STRATA II","STRATA III"],V=["Belum Ditentukan","Belum/Tidak Bekerja","Pelajar/Mahasiswa","Mengurus Rumah Tangga","Buruh Harian Lepas","Buruh Peternakan","Buruh Tani/Perkebunan","Guru","Tentara Nasional Indonesia (TNI)","Kepolisian RI (POLRI)","Karyawan BUMD","Karyawan BUMN","Karyawan Honorer","Karyawan Swasta","Mekanik","Pedagang","Pegawai Negeri Sipil (PNS)","Pensiunan","Perancang Busana","Perawat","Perdagangan","Petani/Pekebun","Peternak","Sopir","Tabib","Transportasi","Tukang Batu","Tukang Cukur","Tukang Jahit","Tukang Kayu","Tukang Las/Pandai Besi","Wiraswasta"],R=["Belum Kawin","Kawin","Cerai Hidup","Cerai Mati"],H=["Kepala Keluarga","Istri","Anak","Orang Tua","Menantu","Mertua","Cucu","Famili Lain","Lainnya"],J=i=>{for(const t in i.errors)i.errors.hasOwnProperty(t)&&(o.value[t]=i.errors[t])},x=i=>{v.message=i,v.show=!0,setTimeout(()=>{v.show=!1},3e3)},$=()=>{d.value>1&&(m.updateAnggota(d.value-1,{...s}),d.value-=1,Object.assign(s,m.anggotaKeluargaForms[d.value-1]))},P=i=>{m.updateAnggota(d.value-1,{...s}),d.value=i,Object.assign(s,m.anggotaKeluargaForms[i-1])},F=async i=>{const t=A.getToken;try{return(await(await fetch(`http://laravel-api.test/api/check-nik?nik=${i}`,{method:"GET",headers:{Accept:"application/json",Authorization:`Bearer ${t}`}})).json()).exists}catch(c){return console.error("Request failed:",c),!1}},q=()=>{let i=!0;o.value={};for(const[t,c]of m.anggotaKeluargaForms.entries()){for(const b in c)if(c.hasOwnProperty(b)&&!c[b]){i=!1,o.value[b]=["Field is required"],P(t+1);break}if(!i)break}return i},S=h(!0),z=async()=>{if(await F(s.nik)){x("NIK sudah ada"),o.value.nik=["NIK sudah ada"];return}m.anggotaKeluargaForms[d.value-1]={...s},o.value={},x("Anggota Keluarga added successfully!"),d.value<T?(d.value+=1,Object.keys(s).forEach(i=>{i!=="keluarga_id"&&(s[i]="")}),S.value=!1):K.value=!0},G=()=>{z(),S.value=!1},Z=async()=>{if(K.value=!1,!q()){x("Silakan isi semua field yang diperlukan.");return}const i=A.getToken;try{for(const[t,c]of m.anggotaKeluargaForms.entries()){if(await F(c.nik)){x("NIK sudah ada"),o.value.nik=["NIK sudah ada"],P(t+1);return}const b=await fetch("http://laravel-api.test/api/anggota_keluargas",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:`Bearer ${i}`},body:JSON.stringify(c)});if(!b.ok){const j=await b.json();if(j.errors){J(j),P(t+1);return}throw new Error("Error creating Anggota Keluarga")}const a=await b.json();c.hubungan_keluarga==="Kepala Keluarga"&&(await fetch(`http://laravel-api.test/api/keluargas/${c.keluarga_id}`,{method:"PUT",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:`Bearer ${i}`},body:JSON.stringify({kepala_keluarga:a.id})}),D.value=!0,N.value=!1)}x("Semua data anggota keluarga berhasil disimpan!"),m.resetForms(),setTimeout(()=>{C.push({path:"/admin/nagari/keluarga/keluargaDetail",query:{id:s.keluarga_id}})},1500)}catch(t){console.error("Request failed:",t)}};return ae(()=>{m.anggotaKeluargaForms[d.value-1]?Object.assign(s,m.anggotaKeluargaForms[d.value-1]):m.addAnggota({...s})}),(i,t)=>{const c=W,b=Y;return r(),n("div",null,[O(c),e("div",ue,[O(b),e("div",de,[e("main",null,[e("div",ge,[e("h1",ce," Create Anggota Keluarga "+u(d.value),1)])]),e("div",me,[e("div",pe,[e("div",be,[_e,e("form",{onSubmit:te(G,["prevent"]),class:"max-w-sm mx-auto"},[e("div",he,[ke,p(e("input",{id:"keluarga_id",type:"text","onUpdate:modelValue":t[0]||(t[0]=a=>s.keluarga_id=a),class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5",readonly:""},null,512),[[w,s.keluarga_id]]),o.value.keluarga_id?(r(),n("span",fe,u(o.value.keluarga_id[0]),1)):g("",!0)]),e("div",ve,[ye,p(e("input",{id:"nama","onUpdate:modelValue":t[1]||(t[1]=a=>s.nama=a),type:"text",class:"bg-gray-50 border border-gray-300 mt-2 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"},null,512),[[w,s.nama]]),o.value.nama?(r(),n("span",xe,u(o.value.nama[0]),1)):g("",!0)]),e("div",we,[Ae,p(e("input",{id:"nik","onUpdate:modelValue":t[2]||(t[2]=a=>s.nik=a),type:"text",class:"block p-2.5 w-full text-sm text-gray-900 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500 mt-2"},null,512),[[w,s.nik]]),o.value.nik?(r(),n("span",Ke,u(o.value.nik[0]),1)):g("",!0)]),e("div",Te,[Pe,p(e("input",{id:"tempat_lahir","onUpdate:modelValue":t[3]||(t[3]=a=>s.tempat_lahir=a),type:"text",class:"block p-2.5 w-full text-sm text-gray-900 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500 mt-2"},null,512),[[w,s.tempat_lahir]]),o.value.tempat_lahir?(r(),n("span",Se,u(o.value.tempat_lahir[0]),1)):g("",!0)]),e("div",je,[Ie,p(e("input",{id:"tanggal_lahir","onUpdate:modelValue":t[4]||(t[4]=a=>s.tanggal_lahir=a),type:"date",class:"block p-2.5 w-full text-sm text-gray-900 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500 mt-2"},null,512),[[w,s.tanggal_lahir]]),o.value.tanggal_lahir?(r(),n("span",Be,u(o.value.tanggal_lahir[0]),1)):g("",!0)]),e("div",Fe,[Me,p(e("select",{id:"agama","onUpdate:modelValue":t[5]||(t[5]=a=>s.agama=a),class:"block p-2.5 w-full text-sm text-gray-900 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500 mt-2"},[Oe,(r(),n(k,null,f(E,a=>e("option",{key:a,value:a},u(a),9,Ce)),64))],512),[[y,s.agama]]),o.value.agama?(r(),n("span",De,u(o.value.agama[0]),1)):g("",!0)]),e("div",Ne,[Ee,p(e("select",{id:"jenis_kelamin","onUpdate:modelValue":t[6]||(t[6]=a=>s.jenis_kelamin=a),class:"block p-2.5 w-full text-sm text-gray-900 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500 mt-2"},[Le,(r(),n(k,null,f(L,a=>e("option",{key:a,value:a},u(a),9,Ue)),64))],512),[[y,s.jenis_kelamin]]),o.value.jenis_kelamin?(r(),n("span",Ve,u(o.value.jenis_kelamin[0]),1)):g("",!0)]),e("div",Re,[He,p(e("select",{id:"pendidikan","onUpdate:modelValue":t[7]||(t[7]=a=>s.pendidikan=a),class:"block p-2.5 w-full text-sm text-gray-900 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500 mt-2"},[Je,(r(),n(k,null,f(U,a=>e("option",{key:a,value:a},u(a),9,$e)),64))],512),[[y,s.pendidikan]]),o.value.pendidikan?(r(),n("span",qe,u(o.value.pendidikan[0]),1)):g("",!0)]),e("div",ze,[Ge,p(e("select",{id:"pekerjaan","onUpdate:modelValue":t[8]||(t[8]=a=>s.pekerjaan=a),class:"block p-2.5 w-full text-sm text-gray-900 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500 mt-2"},[Ze,(r(),n(k,null,f(V,a=>e("option",{key:a,value:a},u(a),9,We)),64))],512),[[y,s.pekerjaan]]),o.value.pekerjaan?(r(),n("span",Ye,u(o.value.pekerjaan[0]),1)):g("",!0)]),e("div",Qe,[Xe,p(e("select",{id:"status_perkawinan","onUpdate:modelValue":t[9]||(t[9]=a=>s.status_perkawinan=a),class:"block p-2.5 w-full text-sm text-gray-900 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500 mt-2"},[ea,(r(),n(k,null,f(R,a=>e("option",{key:a,value:a},u(a),9,aa)),64))],512),[[y,s.status_perkawinan]]),o.value.status_perkawinan?(r(),n("span",ta,u(o.value.status_perkawinan[0]),1)):g("",!0)]),e("div",sa,[oa,p(e("select",{id:"hubungan_keluarga","onUpdate:modelValue":t[10]||(t[10]=a=>s.hubungan_keluarga=a),class:"block p-2.5 w-full text-sm text-gray-900 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500 mt-2"},[na,(r(),n(k,null,f(H,a=>e("option",{key:a,value:a},u(a),9,ra)),64))],512),[[y,s.hubungan_keluarga]]),o.value.hubungan_keluarga?(r(),n("span",la,u(o.value.hubungan_keluarga[0]),1)):g("",!0)]),e("div",ia,[d.value>1?(r(),n("button",{key:0,type:"button",onClick:$,class:"text-white bg-gray-500 hover:bg-gray-600 focus:ring-4 focus:ring-gray-300 font-medium rounded-lg text-sm px-5 py-2.5 mr-2 mb-2"}," Kembali ")):g("",!0),S.value||d.value===I(T)?(r(),n("button",ua,u(d.value===I(T)?"Add Anggota Keluarga":"Next"),1)):g("",!0)])],32),e("div",da,[(r(!0),n(k,null,f(I(T),a=>(r(),n("span",{key:a,class:se(["px-2 py-1 rounded-full cursor-pointer",d.value===a?"bg-blue-500 text-white":"bg-gray-200 text-gray-800"]),onClick:j=>P(a)},u(a),11,ga))),128))])])])])])]),v.show?(r(),n("div",ca,[ma,e("div",pa,u(v.message),1),e("button",{onClick:t[11]||(t[11]=a=>v.show=!1),type:"button",class:"ml-auto -mx-1.5 -my-1.5 bg-white text-gray-400 hover:text-gray-900 rounded-lg focus:ring-2 focus:ring-gray-300 p-1.5 hover:bg-gray-100 inline-flex items-center justify-center h-8 w-8","aria-label":"Close"},ha)])):g("",!0),K.value?(r(),n("div",ka,[e("div",fa,[va,ya,e("div",xa,[e("button",{onClick:t[12]||(t[12]=a=>K.value=!1),class:"text-white bg-gray-500 hover:bg-gray-600 focus:ring-4 focus:ring-gray-300 font-medium rounded-lg text-sm px-5 py-2.5 mr-2 mb-2"}," Batal "),e("button",{onClick:Z,class:"text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 mb-2"}," Konfirmasi ")])])])):g("",!0)])}}},Ia=le(wa,[["__scopeId","data-v-27e5a71c"]]);export{Ia as default};
